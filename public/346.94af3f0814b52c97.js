"use strict";(self.webpackChunkdaily_front=self.webpackChunkdaily_front||[]).push([[346],{9346:(D,m,s)=>{s.r(m),s.d(m,{CloudModule:()=>W});var f=s(9808),u=s(6010),e=s(1223);let x=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-cloud"]],decls:2,vars:0,consts:[[1,"content"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"router-outlet"),e.qZA())},directives:[u.lC],encapsulation:2}),o})();var M=s(108),A=s(7194),R=s(3900),v=s(3961),d=s(520),b=s(2340),h=s(4004),$=s(8505),p=s(262),U=s(7579),y=s(9646),N=s(629);let C=(()=>{class o{constructor(t,i){this.http=t,this.authService=i,this.baseUrl=b.N.API_URL,this.tokenItem="token",this.url=`${this.baseUrl}/activity`,this.activities$=new U.x,this.activities=[],this.getUser()}getUser(){this.authService.validToken.subscribe(),this.authService.user.subscribe(t=>{t.uid.length>0&&this.http.get(`${this.baseUrl}/user/${t.uid}`).pipe((0,h.U)(n=>n.message.activities)).subscribe(n=>{this.activities=n,this.activities$.next(n)})})}refersh(){this.activities$.next(this.activities)}get routine(){return this.activities$.asObservable()}findActivity(t){return this.activities.find(i=>i.id===t)}addActivity(t){var i;const n=t,c=null!==(i=localStorage.getItem(this.tokenItem))&&void 0!==i?i:"",l=(new d.WM).set("x-token",c);return this.http.post(this.url,n,{headers:l}).pipe((0,$.b)(a=>{this.activities.push(a.message),this.activities$.next(this.activities)}),(0,h.U)(a=>a),(0,p.K)(a=>(0,y.of)(a)))}updateActivity(t){var i;const n=t,c=null!==(i=localStorage.getItem(this.tokenItem))&&void 0!==i?i:"",l=(new d.WM).set("x-token",c);return this.http.patch(this.url,n,{headers:l}).pipe((0,h.U)(a=>a),(0,p.K)(a=>(0,y.of)(a)))}removeActivity(t){var i;const n=null!==(i=localStorage.getItem(this.tokenItem))&&void 0!==i?i:"",c=(new d.WM).set("x-token",n);return this.http.delete(`${this.url}/${t}`,{headers:c}).pipe((0,h.U)(l=>l),(0,p.K)(l=>(0,y.of)(l)))}orderByStartTime(t){return t.sort((i,n)=>{var c,l;const a=null===(c=i.startTime)||void 0===c?void 0:c.split(":"),g=Number(a[0]),S=Number(a[1]),E=null===(l=n.startTime)||void 0===l?void 0:l.split(":"),T=Number(E[0]),I=Number(E[1]);return g>T?1:g<T?-1:S>I?1:S<I?-1:0}),t}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(d.eN),e.LFG(N.e))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var F=s(2856);function Z(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"app-activity",2),e.NdJ("deleteEvent",function(n){return e.CHM(t),e.oxw().deleteActivity(n)})("updateEvent",function(n){return e.CHM(t),e.oxw().updateActivity(n)})("addEvent",function(n){return e.CHM(t),e.oxw().addActivity(n)})("closeEvent",function(){return e.CHM(t),e.oxw().closeActivity()}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("activity",t.activity)}}function O(o,r){1&o&&(e.TgZ(0,"div",3),e._uU(1,"Activity not found."),e.qZA())}let Q=(()=>{class o{constructor(t,i,n){this.route=t,this.router=i,this.cloudService=n,this.initialActivity=new M.c("","A","A A A","00:00",5,""),this.hadActivity=!1,this.activityId="",this.errors=[]}ngOnInit(){this.route.paramMap.pipe((0,R.w)(t=>{var i;return this.activityId=null!==(i=t.get("id"))&&void 0!==i?i:"",this.evalActivity(),this.activityId})).subscribe()}evalActivity(){var t;if(this.activityId===A.e.NEW)this.setActivityData(this.initialActivity,!0);else{const i=null!==(t=this.cloudService.findActivity(this.activityId))&&void 0!==t?t:this.initialActivity;this.setActivityData(i)}}setActivityData(t,i=!1){this.activity=t,this.hadActivity=Boolean(t.id)||i}deleteActivity(t){this.cloudService.removeActivity(t).subscribe(i=>{this.errors=[],i.status!==v.Q.SUCCESS?(i.status===v.Q.ERROR&&Array.isArray(i.message)?i.message.forEach(n=>{this.errors.push(`${n.param} is ${n.error}.`)}):this.errors.push("Something went wrong, please try again later."),console.error(this.errors)):console.log(i)})}updateActivity(t){this.cloudService.updateActivity(t).subscribe(i=>{this.errors=[],i.status!==v.Q.SUCCESS?(i.status===v.Q.ERROR&&Array.isArray(i.message)?i.message.forEach(n=>{this.errors.push(`${n.param} is ${n.error}.`)}):this.errors.push("Something went wrong, please try again later."),console.error(this.errors)):console.log(i.message)})}addActivity(t){console.log(t),this.cloudService.addActivity(t).subscribe(i=>{this.errors=[],i.status!==v.Q.SUCCESS?(i.status===v.Q.ERROR&&Array.isArray(i.message)?i.message.forEach(n=>{this.errors.push(`${n.param} is ${n.error}.`)}):this.errors.push("Something went wrong, please try again later."),console.error(this.errors)):console.log(i)})}closeActivity(){this.router.navigate(["cloud"])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.gz),e.Y36(u.F0),e.Y36(C))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cloud-activity"]],decls:3,vars:2,consts:[[3,"activity","deleteEvent","updateEvent","addEvent","closeEvent",4,"ngIf","ngIfElse"],["nofound",""],[3,"activity","deleteEvent","updateEvent","addEvent","closeEvent"],[1,"alert__nofound"]],template:function(t,i){if(1&t&&(e.YNc(0,Z,1,1,"app-activity",0),e.YNc(1,O,2,0,"ng-template",null,1,e.W1O)),2&t){const n=e.MAs(2);e.Q6J("ngIf",i.hadActivity)("ngIfElse",n)}},directives:[f.O5,F.y],encapsulation:2}),o})();var Y=s(5700),J=s(5817);const w=[{path:"",component:x,children:[{path:"",component:(()=>{class o{constructor(t,i,n){this.route=t,this.router=i,this.cloudService=n,this.routine=[]}ngOnInit(){this.cloudService.routine.subscribe(t=>{this.routine=t,console.log("routine",t)}),0===this.routine.length&&this.cloudService.refersh()}showActivity(t){this.router.navigate([`activity/${t}`],{relativeTo:this.route})}clickEventAdd(){this.router.navigate([`activity/${A.e.NEW}`],{relativeTo:this.route})}ngOnDestroy(){console.log("destroy")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.gz),e.Y36(u.F0),e.Y36(C))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cloud-routine"]],decls:2,vars:1,consts:[[3,"routine","activityId"],["title","Add Activity","color","#00b894",3,"clickEvent"]],template:function(t,i){1&t&&(e.TgZ(0,"app-routine",0),e.NdJ("activityId",function(c){return i.showActivity(c)}),e.qZA(),e.TgZ(1,"util-btn",1),e.NdJ("clickEvent",function(){return i.clickEventAdd()}),e.qZA()),2&t&&e.Q6J("routine",i.routine)},directives:[Y.l,J.H],encapsulation:2}),o})()},{path:"activity/:id",component:Q},{path:"**",redirectTo:"",pathMatch:"full"}]}];let H=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[u.Bz.forChild(w)],u.Bz]}),o})();var z=s(5784),B=s(4603);let W=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[f.ez,H,z.N,B.A]]}),o})()}}]);